Function copyright of Ronald Speelman with minor modifications by Peter Russ<peter.2015@uon.li>
Found at http://moinne.com/blog/ronald/tag/functions